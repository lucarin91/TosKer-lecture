\documentclass{beamer}

% \input{../definitions}

\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}

% \usepackage[backend=bibtex, sorting=nty, style=numeric]{biblatex}
% \addbibresource{../references.bib}

\usetheme{Frankfurt}
\usecolortheme{whale}
% #3778C6
\definecolor{myblue1}{RGB}{55,120,198}
\definecolor{myblue2}{RGB}{37,78,136}
\definecolor{myblue3}{RGB}{0,20,137}
% \definecolor{white}{RGB}{255,255,255}
% \definecolor{black}{RGB}{0,0,0}


\setbeamercolor*{frametitle}{fg=white,bg=myblue2}
\setbeamercolor*{title}{fg=white,bg=myblue2}
\setbeamercolor*{structure}{fg=myblue2}


\title[About Beamer] %optional
{Orchestrating applications with\\ TOSCA and Docker}

% \subtitle{A short story}

\author[lucarin91] % (optional, for multiple authors)
{Luca Rinaldi}

\institute[unipi] % (optional)
{
  {\small University of Pisa}
}

% \logo{\includegraphics[height=1.5cm]{../thesis/style/logo.png}}

\date[2017] % (optional)
{
  {\small June 2017}
}

% \AtBeginSubsection[]
% {
% \begin{frame}{Table of Contents}
% \tableofcontents[
%   currentsection,
%   currentsubsection,
%   sectionstyle=show/shaded,
%   subsectionstyle=show/shaded
% ]
% \end{frame}
% }
\AtBeginSection[]{
  \begin{frame}{Table of Contents}
    \tableofcontents[currentsection]
  \end{frame}
}

\begin{document}
\begin{frame}
  \maketitle
\end{frame}

% \begin{frame}{Table of Contents}
%   \tableofcontents
% \end{frame}

\section{Context}\subsection*{}

  \begin{frame}{Software deployment}
    The execution of all the activities that make a software system available to use.

    Nowadays strictly related to the cloud infrastructure.

    Need of a way to express all the \textbf{requirements} that the application needs to run.
  \end{frame}


\section{Docker}\subsection*{}

  \begin{frame}{Docker}
    \begin{figure}
      \includegraphics[width=0.8\textwidth]{img/docker.png}
    \end{figure}
    % Docker containers wrap up the software and all the requirements: code, runtime, system tools, system libraries.
    % This guarantees that the software always run in all environment that support Docker.
  \end{frame}

  \begin{frame}{Docker: What?}
    \begin{figure}
      \includegraphics[width=1\textwidth]{img/docker_vs_vm.png}
    \end{figure}
  \end{frame}

  \begin{frame}{Docker: Architecture}
    \begin{figure}
      \includegraphics[width=0.8\textwidth]{img/docker_achitecture_crop.png}
    \end{figure}
    \begin{itemize}
      \item LXC %TODO: add spiegazione
      \item LAYER FS
      \item CGROUPS
      \item NAME SPACE
      \item LINUX KERNEL
    \end{itemize}
  \end{frame}

  \begin{frame}{Docker: main comcepts}
    Main concept of the Docker platform
    \begin{itemize}
      \item \textbf{Dockerfile}, a scripts to generate an Image
      \item \textbf{Docker Image}, a LAYER FS archive whit all the data
      \item \textbf{Docker Container}, Running instance of a Docker Image
      \item \textbf{Docker Volume}, a persistent data storage
      \item \textbf{Docker Hub}, a Database of Docker Image open to comunity
    \end{itemize}
  \end{frame}

  \begin{frame}{Docker: for deploy application}
    \begin{figure}
      \includegraphics[width=1\textwidth]{img/docker_build.pdf}
    \end{figure}
  \end{frame}

  \begin{frame}{Docker: multicontainer}
    \begin{figure}
      \includegraphics[width=1\textwidth]{img/docker_multicontainer.pdf}
    \end{figure}
  \end{frame}

  \begin{frame}{Problems}
    \begin{itemize}
      \item[\textcolor{red}{\textbf{--}}] Poor application orchestration
      \item[\textcolor{red}{\textbf{--}}] The container hide the components that it contains
      \item[\textcolor{red}{\textbf{--}}] Can orchestrate only container
    \end{itemize}
  \end{frame}

\section{TOSCA}\subsection*{}
  \begin{frame}{TOSCA: What?}
    OASIS standard language to describe the topology of an application, with its components and relationships.
    \bigskip

    \centering
    \textbf{Describe every part of your application!}
  \end{frame}

  \begin{frame}{TOSCA: main concept}
    \begin{figure}
      \includegraphics[width=0.9\textwidth]{img/service-template.png}
    \end{figure}
  \end{frame}

  \begin{frame}{TOSCA: Node type}
    \begin{figure}
      \includegraphics[width=0.3\textwidth]{img/tosca_node_type.png}
    \end{figure}
    \begin{itemize}
      \item \textbf{requirements}, what the node require
      \item \textbf{capabilities}, what the node offer
      \item \textbf{properties}, the properties of the node
      \item \textbf{interfaces}, the operation to implement
      \item \textbf{artifacts}, the data need to use the node
    \end{itemize}
  \end{frame}

  \begin{frame}{TOSCA main concepst}
      \begin{itemize}
        \item the description use a YAML destription
        \item CSAR its an archive with the YAML description and all the artifacts
      \end{itemize}
  \end{frame}

  \begin{frame}{TOSCA: how it works}
    \begin{itemize}
      \item create an archive (.CSAR) whit the description and artifacts
      \item send to acompatible infrastructure
      \item following the description and using the artifacts the application can deploy
    \end{itemize}
  \end{frame}

  \begin{frame}{Orchestration}
    \begin{figure}
      \includegraphics[width=\textwidth]{img/tosca_deploy.png}
    \end{figure}
  \end{frame}

  \begin{frame}{Problems}
    \begin{itemize}
      \item[\textcolor{red}{\textbf{--}}] The specification can become too verbose
      \item[\textcolor{red}{\textbf{--}}] A good standard but not a product
      \item[\textcolor{red}{\textbf{--}}] Lack of engines which accept TOSCA description
    \end{itemize}
  \end{frame}

\section{TosKer}\subsection*{}
  \begin{frame}{TosKer}
    An orchestration engine capable of deploying, on top of Docker, applications described in TOSCA YAML.
  \end{frame}

  \begin{frame}{TosKer: what?}
    TosKer inputs a TOSCA description of a multi-component application, where some components are Docker containers and Docker volumes, and automatically deploys and orchestrates it using the Docker engine.
  \end{frame}

  \begin{frame}{Describing applications in TosKer}
    \begin{itemize}
      \item Applications are specified as a composition of the following components:\begin{itemize}
          \item \small\emph{Docker containers} {\tiny\texttt{tosker.nodes.Container}}
          \item \small\emph{Docker volumes} {\tiny\texttt{tosker.nodes.Volume}}
          \item \small\emph{Software} {\tiny\texttt{tosker.nodes.Software}}
        \end{itemize}\pause
      \item There can be the following relationships between components:\begin{itemize}
          \item \small\emph{hosted on} {\tiny\texttt{tosca.relationships.HostedOn}}
          \item \small\emph{connected to} {\tiny\texttt{tosca.relationships.ConnectsTo}}
          \item \small\emph{attached to} {\tiny\texttt{tosca.relationships.AttachesTo}}
          \item \small\emph{depending on} {\tiny\texttt{tosca.relationships.DependsOn}}
        \end{itemize}
    \end{itemize}
  \end{frame}

  \begin{frame}{tosker.nodes.Container}
    \begin{figure}
      \includegraphics[width=0.8\textwidth]{img/tosker_types_container.pdf}
    \end{figure}
  \end{frame}

  \begin{frame}{tosker.nodes.Software}
    \begin{figure}
      \includegraphics[width=0.8\textwidth]{img/tosker_types_software.pdf}
    \end{figure}
  \end{frame}

  \begin{frame}{tosker.nodes.Volume}
    \begin{figure}
      \includegraphics[width=0.8\textwidth]{img/tosker_types_volume.pdf}
    \end{figure}
  \end{frame}

  \begin{frame}{Constrains}
    Each application must meet some constrains, e.g.,
    \begin{itemize}
      \item \small A \emph{software} must be ``\emph{hosted on}'' another \emph{software} or a \emph{Docker container}
      \item \small A \emph{Docker container} and \emph{Docker volume} cannot be ``\emph{hosted on}'' other components
      \item \small Only \emph{Docker containers} can be ``\emph{attached to}'' \emph{Docker volumes}
    \end{itemize}
  \end{frame}

  \begin{frame}{Case study: Thoughts}
    \begin{figure}
      \includegraphics[width=\textwidth]{img/thoughts_architecture.pdf}
    \end{figure}
  \end{frame}

  \begin{frame}{Architecture}
    \begin{figure}
      \includegraphics[width=\textwidth]{img/architecture.png}
    \end{figure}
  \end{frame}

  \begin{frame}[t]{How TosKer orchestrates applications}
    % \vspace*{-.5em}
    \only<1>{
      \begin{figure}
        \includegraphics[width=.9\textwidth]{img/tosker_how_1.pdf}
      \end{figure}
      The input of TosKer is
      \begin{itemize}
        \item a TOSCA application specified using TosKer types, and
        \item management operation(s) to perform.
      \end{itemize}
    }
    \only<2>{
      \begin{figure}
        \includegraphics[width=.9\textwidth]{img/tosker_how_2.pdf}
      \end{figure}
      \vspace*{-.5em}
      TosKer
      \begin{itemize}
        \item parses and validates the TOSCA application, and
        % \item create an internal representation of the application
        \item executes a topological sorting algorithm.
      \end{itemize}
    }
    \only<3>{
      \begin{figure}
        \includegraphics[width=.9\textwidth]{img/tosker_how_3.pdf}
      \end{figure}
      \vspace*{-.5em}
      TosKer %exploits the (topologically sorted) application to orchestrate it:
      \begin{itemize}
        \item scans the sorted application topology, and
        \item for each component, it calls a specific operation (e.g., create)
      \end{itemize}
    }
    \only<4>{
      \begin{figure}
        \includegraphics[width=.9\textwidth]{img/tosker_how_4.pdf}
      \end{figure}
      Each manager is in charge of implementing/executing the invoked operation on a component...
    }
    \only<5>{
      \begin{figure}
        \includegraphics[width=.9\textwidth]{img/tosker_how_5.pdf}
      \end{figure}
      ...by properly invoking the Docker engine (through the Docker interface)
    }
  \end{frame}

  \begin{frame}{Implementation}
    \begin{columns}[b]
      \begin{column}{.3\textwidth}
        \centering
        % \onslide<1->{
          \begin{figure}
            \includegraphics[width=.6\textwidth]{img/python.png}
          \end{figure}
          {\large Python}
        % }
      \end{column}
      \begin{column}{.3\textwidth}
        \centering
        % \onslide<2->{
          \begin{figure}
            \includegraphics[width=.6\textwidth]{img/github.png}
          \end{figure}
          {\large GitHub}
        % }
      \end{column}
      \begin{column}{.3\textwidth}
        \centering
        % \onslide<2>{
          \begin{figure}
            \includegraphics[width=.6\textwidth]{img/mit.png}
          \end{figure}
          {\large MIT Licence}
        % }
      \end{column}
    \end{columns}
      \vspace{20pt}
      \begin{itemize}
        \item %\onslide<1->{
          \small\textbf{PyPI}: \href{https://pypi.python.org/pypi/tosKer}{https://pypi.python.org/pypi/tosKer}\\
          \indent\indent\texttt{pip install tosker}\vspace{10pt}
        % }
        \item %\onslide<2>{
          \small\textbf{GitHub}: \href{https://github.com/di-unipi-socc/TosKer}{https://github.com/di-unipi-socc/TosKer}
        % }
      \end{itemize}
  \end{frame}

  \begin{frame}{Advantages and Limitations}

  \end{frame}

\section{Conclusion and Future works}\subsection*{}

  \begin{frame}{Future works}

  \end{frame}

  \begin{frame}{Conclusions}

  \end{frame}

  \begin{frame}
    \centering
    \Huge Thank You \\
    \bigskip
    \LARGE Q\&A
  \end{frame}
\end{document}
